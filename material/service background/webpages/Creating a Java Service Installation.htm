<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Creating a Java Service Installation</title><meta name="description" content="A step by step tutorial depicting the creation of a Java
      Service installation in Advanced Installer."><link type="text/css" rel="stylesheet" href="Creating%20a%20Java%20Service%20Installation_files/style-ug.css"><script src="Creating%20a%20Java%20Service%20Installation_files/ga.js" async="" type="text/javascript"></script><script src="Creating%20a%20Java%20Service%20Installation_files/aws.js" async="" type="text/javascript"></script><script type="text/javascript">
      var _awsq = _awsq || [];
      _awsq.push('_aws_setAccount', '0959f9f2636da2301d2943ae77f3d6ff');
      _awsq.push('_aws_setTrackerMode', '1');
      _awsq.push('_aws_tracker');
      (function() {
        var aws = document.createElement('script'); aws.type = 'text/javascript'; aws.async = true;
        aws.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + '//www.caphyon-analytics.com/aws.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(aws, s);
      })();
    </script><script language="JavaScript1.5">aP='1.5';</script><script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-61715-1']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);      
      _gaq.push(['_setAllowHash', false]);
      _gaq.push(['_trackPageview']);
      
      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script></head><body><div id="main"><!--[if lt IE 7]> 
        <script src="/js/DD_belatedPNG_0.0.8a.js" type="text/javascript"></script> 
        <script type="text/javascript">DD_belatedPNG.fix('#ai-logo, #caphyon-logo, #prod-options, #prod-options a'); </script>
      <![endif]--><script type="text/javascript" src="Creating%20a%20Java%20Service%20Installation_files/jquery.js"></script><script type="text/javascript" src="Creating%20a%20Java%20Service%20Installation_files/common.js"></script><div id="main-menu"><div class="cont-width"><ul><li class="map-first"><a href="http://www.advancedinstaller.com/download.html" title="Download Advanced Installer">Download</a></li><li><a href="http://www.advancedinstaller.com/features.html" title="Software Installation Tool Features">Features</a></li><li><a href="http://www.advancedinstaller.com/java.html" title="Installer for Java Applications">Java</a></li><li><a href="http://www.advancedinstaller.com/licenses.html" title="Licensing Advanced Installer: editions, maintenance plans">Licensing</a></li><li><a href="http://www.advancedinstaller.com/purchase.html" title="Purchase Advanced Installer licenses">Purchase</a></li><li><a href="http://www.advancedinstaller.com/support.html" title="Advanced Installer Support">Support</a></li><li class="map-last"><a href="http://www.advancedinstaller.com/forums" title="Advanced Installer Forums">Forums</a></li></ul><div class="float-right"><a id="caphyon-logo" title="by Caphyon" href="http://www.caphyon.com/">Caphyon</a></div><div class="float-right" id="ai-searchbox"><form action="../search.html" id="cse-search-box"><div><input name="cx" value="006686361644407349086:yneweleowua" type="hidden"><input name="cof" value="FORID:9" type="hidden"><input name="ie" value="UTF-8" type="hidden"><input name="q" id="gcse" onfocus="clearTextInput(this);" onblur="undoTextInput(this);" type="text"></div></form></div><div class="clear"></div></div></div><div id="pagehead-bg"><div id="pagehead"><div class="cont-width"><a id="ai-logo" class="float-left" title="Windows Installer" href="http://www.advancedinstaller.com/index.html">Advanced Installer</a><div class="float-left"><div id="ai-title">Advanced Installer User Guide</div><h1>Creating a Java Service Installation</h1></div><div id="prod-options" class="float-right"><a id="prod-purchase" href="http://www.advancedinstaller.com/purchase.html" title="Purchase Advanced Installer licenses">Buy</a><a id="prod-download" href="http://www.advancedinstaller.com/download.html" title="Download Advanced Installer">Download</a></div><div class="clear"></div></div></div></div><table class="page"><tbody><tr><td class="topics"><div style="width: 323px;" id="sidebar-wrapper"><div style="position: static; margin-top: 0px; top: 0px;" id="sidebar-sep"><ul><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/introduction.html" title="An introduction to the Advanced Installer software.">Introduction</a></li><li class="map-closed"><a href="http://www.advancedinstaller.com/user-guide/register-ai.html" title="Registration options for Advanced Installer.">Registration</a></li><li class="map-closed"><a href="http://www.advancedinstaller.com/user-guide/using.html" title="A guide to using Advanced Installer, from the GUI to the Command Line and Shell integration.">Using Advanced Installer</a></li><li class="map-closed"><a href="http://www.advancedinstaller.com/user-guide/features.html" title="Detailed descriptions and explanations for selected features and functionalities of the application.">Features and Functionality</a></li><li class="map-open"><a href="http://www.advancedinstaller.com/user-guide/tutorials-qa.html" title="Step by step Tutorials, detailed How To's and various Questions and Answers.">Tutorials, How To's, Q&amp;A</a><ul><li class="map-open"><a href="http://www.advancedinstaller.com/user-guide/tutorials.html" title="Step by step tutorials that will guide you in creating different types of projects or in using certain features.">Tutorials</a><ul><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-simple.html" title="A step by step tutorial describing the creation of the simplest possible Windows Installer MSI package, using Advanced Installer.">Simple Installation</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-professional.html" title="A step by step tutorial depicting the creation of a professional Advanced Installer installation.">Professional Installation</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-professional-cli.html" title="Creating a Professional project from CLI.">Professional Installation from CLI</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-transforms.html" title="A step by step tutorial describing the creation and editing of a Windows Installer transform, using Advanced Installer.">Creating transforms</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-appv.html" title="A step by step tutorial depicting the creation of an App-V or App-V 5 Package in Advanced Installer.">Creating an App-V Package</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-thinapp.html" title="A step by step tutorial to create a ThinApp Package in Advanced Installer.">Creating a ThinApp Package</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-sharepoint-solution.html" title="Step by step tutorial on how to create a project for a SharePoint solution.">SharePoint Solution Installers</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-languages.html" title="A step by step tutorial depicting the creation of Windows Installer MSI packages localized in other languages using Advanced Installer.">Other Languages</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-new-language.html" title="A step by step tutorial explaining how to translate and create MSI packages in a new language.">New Language</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-java.html" title="A step by step tutorial depicting the creation of a Java Product installation in Advanced Installer.">Java Product Installation</a></li><li class="map-leaf map-current"><a href="http://www.advancedinstaller.com/user-guide/tutorial-java-service.html" title="A step by step tutorial depicting the creation of a Java Service installation in Advanced Installer.">Java Service Installation</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/IntelliJ-IDEA-import.html" title="Short tutorial explaining how to import an IntelliJ IDEA project/module and create a setup package for it.">IntelliJ IDEA import</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-patch.html" title="A step by step tutorial depicting the creation of a Windows Installer patch in Advanced Installer.">Patch Authoring</a></li><li class="map-closed"><a href="http://www.advancedinstaller.com/user-guide/tutorial-updates-deployment.html" title="Step by step tutorials that guide you in using Advanced Updater to automatically deploy updates to your users.">Deploying Updates</a></li><li class="map-closed"><a href="http://www.advancedinstaller.com/user-guide/tutorial-dialog-editing.html" title="Step by step tutorials that guide you in using the dialogs editor from Advanced Installer.">Using the Dialog Editor</a></li><li class="map-closed"><a href="http://www.advancedinstaller.com/user-guide/tutorial-sql-connections.html" title="Step by step tutorial on how to set a MS-SQL, MySQL, Oracle and Postgre SQL connection.">Configure most common SQL connections</a></li><li class="map-closed"><a href="http://www.advancedinstaller.com/user-guide/convert-legacy-installations.html" title="Choose the preferred project type to author a MSI installation package which installs existing EXE packages.">Convert Legacy Installations</a></li><li class="map-closed"><a href="http://www.advancedinstaller.com/user-guide/tutorial-vs.html" title="Visual Studio tutorials.">Visual Studio Tutorials</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-rad-tools-integration.html" title="RAD Tool integration guidelines">RAD Tools Integration</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-import-msi.html" title="Step by step tutorial on how to import a MSI into an Advanced Installer project.">MSI Import</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-import-appv.html" title="Importing an App-V Package">App-V Import</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-import-wise.html" title="Step by step tutorial on how to import a WISE project into an Advanced Installer project.">WISE Import</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-sql.html" title="Step by step tutorial on using SQL Scripts.">Using SQL Scripts</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-iis.html" title="Step by step tutorial on configuring IIS Web Sites and Virtual Directories.">IIS Tutorial</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-gpo.html" title="Step by step tutorial on how to deploy a MSI package through GPO.">Deploy a MSI through GPO</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-licensing.html" title="Step by step tutorial on how to create a VB application that integrates the licensing functionality.">Add trial support to your VB application</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-multiple-builds.html" title="Step by step tutorial on how to create a project with multiple build configurations.">Multiple Builds</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-XML-locator.html" title="Step by step tutorial describing how to create an XML locator search in Advanced Installer.">XML Locator Search</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-msm-configurable-parameters.html" title="A step by step tutorial detailing how to create and use basic MSM packages with configurable parameters">MSM with parameters for custom actions</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/tutorial-winmobile.html" title="Step by step tutorial on how to use the Advanced Installer Windows Mobile/CE features.">Windows Mobile/CE Installations</a></li></ul></li><li class="map-closed"><a href="http://www.advancedinstaller.com/user-guide/questions-answers.html" title="Explanations for implementing custom features into your installation.">How To's</a></li><li class="map-closed"><a href="http://www.advancedinstaller.com/user-guide/faq.html" title="Frequently Asked Questions.">FAQ's</a></li></ul></li><li class="map-closed"><a href="http://www.advancedinstaller.com/user-guide/windows-installer.html" title="Documentation of selected Windows Installer features and abilities.">Windows Installer</a></li><li class="map-closed"><a href="http://www.advancedinstaller.com/user-guide/ug-deployment-technologies.html" title="Technologies used by Advanced Installer to deploy your applications.">Deployment Technologies</a></li><li class="map-leaf"><a href="http://www.advancedinstaller.com/user-guide/index.html" title="User Guide Table of Contents">Table of Contents</a></li></ul></div></div></td><td class="content ug"><div class="page-content-inner"><p>Let's say that we want to create a Windows Installer package for the
        included Java Service example. This tutorial will present in detail how
        to achieve this goal. In order to replicate it on your own machine, you
        need to have a (latest) Sun JDK installed. </p><p>Before you start the tutorial download and unzip the <a href="http://www.advancedinstaller.com/examples/javaserviceexample.zip" title="Java Service Example Files">Java Service
          Example</a>. It contains all the files necessary to accomplish
        this tutorial, including a sample Advanced Installer
        project.</p><ul class="toc"><li>1. <a href="#preparing">Prepare a Java application for running as a service</a></li><li>2. <a href="#create-project">Create project</a></li><li>3. <a href="#product-details">Enter Product Details</a></li><li>4. <a href="#set-parameters">Set Install Parameters</a></li><li>5. <a href="#add-files">Add Installation Files</a></li><li>6. <a href="#define-products">Define Java Products</a></li><li>7. <a href="#define-service">Define the Service</a></li><li>8. <a href="#build">Build</a></li><li>9. <a href="#testing">Run, test and remove</a></li></ul><h2><a name="preparing"></a>1. Prepare a Java application for running as a service</h2><p>You have the choice of using the supplied example application
          or making your own. In order for a Java application to work correctly
          as a service you must implement 2 methods in its main
          class:</p><pre>public static void main(String argv[])
{
  // implementation goes here
}

public static void stop()
{
  // implementation goes here
} </pre><p>The main() method will be called when the service starts and
          the stop() method will be called when service must stop or the
          computer is shutting down.</p><h2><a name="create-project"></a>2. Create project</h2><p>Start Advanced Installer by selecting it from the “Start” menu.
          Launching Advanced Installer automatically starts a new installation project. Choose
            “Java” &gt; “Java Application” as
          the project type.</p><p><img src="Creating%20a%20Java%20Service%20Installation_files/new-project.png" alt="Start Page" title="Start Page" height="277" width="704"></p><p><img src="Creating%20a%20Java%20Service%20Installation_files/project-save.png" alt="Save" class="float-left" title="Save" height="24" width="24"> A good idea is to save and name the
          project at this point. Use the “Save” menu item under the
            “File” menu or the <span class="shortcut">Ctrl+S</span> keyboard
          shortcut and let's name it javaserviceexample.aip.</p><h2><a name="product-details"></a>3. Enter Product Details</h2><p><img src="Creating%20a%20Java%20Service%20Installation_files/product-details.png" alt="Product Details" title="Product Details" height="202" width="382"></p><p>Please note that these details are completely
          fictive.</p><h2><a name="set-parameters"></a>4. Set Install Parameters</h2><p><img src="Creating%20a%20Java%20Service%20Installation_files/install-parameters.png" alt="Install Parameters" class="float-left" title="Install Parameters" height="24" width="24"> Get to the Install
          Parameters page by clicking “Install Parameters” on
          the left pane page menu. We won't change anything here, leaving
          everything to their default values.</p><h2><a name="add-files"></a>5. Add Installation Files</h2><p><img src="Creating%20a%20Java%20Service%20Installation_files/files-folders.png" alt="Files and Folders" class="float-left" title="Files and Folders" height="24" width="24"> Go to the Files and
          Folders page by clicking on “Files and Folders” on
          the left pane page menu.</p><p><img src="Creating%20a%20Java%20Service%20Installation_files/folder-add.png" alt="Add Folder" class="float-left" title="Add Folder" height="24" width="24"> Right click
            “Application Folder” and select “Add
            Files”. Browse to where you unzipped the Java Service example
          then go to the lib folder and select the Java Services example jar
          archive "javaservice.jar". Click <span class="shortcut">OK</span>.</p><p><img src="Creating%20a%20Java%20Service%20Installation_files/files-folders_002.png" alt="Files, Folders and Shortcuts" title="Files, Folders and Shortcuts" height="137" width="467"></p><h2><a name="define-products"></a>6. Define Java Products</h2><p><img src="Creating%20a%20Java%20Service%20Installation_files/java.png" alt="Java Products" class="float-left" title="Java Products" height="24" width="24"> Go to the Java Products page by clicking on
            “Java Products” on the left side page
          menu.</p><p><img src="Creating%20a%20Java%20Service%20Installation_files/java-new.png" alt="New Java Product" class="float-left" title="New Java Product" height="24" width="24"> Create a new
            <span class="button">[ Java Product ]</span> by clicking on the New Product toolbar
          button. Let's call it javaservice.</p><p><img src="Creating%20a%20Java%20Service%20Installation_files/java-products.png" alt="Java Products" title="Java Products" height="92" width="128"></p><p>Click on the <span class="button">[ Add JAR(s)... ]</span> button and browse
          to and select the javaservice.jar file. Click
          <span class="shortcut">OK</span>.</p><p>Edit the Main class to:
          com.caphyon.service.JavaService.</p><p>At the application type select “Win32
            Service”.</p><p><img src="Creating%20a%20Java%20Service%20Installation_files/product-settings.png" alt="Product Settings" title="Product Settings" height="732" width="619"></p><p>Now a new file has appeared in the Files and Folders Page:
          javaservice.exe.</p><p class="alert alert-note"><span class="icon-placeholder" title="Note"><img src="Creating%20a%20Java%20Service%20Installation_files/note.png" alt="Note" height="36" width="36"></span>If the service terminates unexpectedly from time to time or when
          the user logs off, the Java Virtual Machine may receive incorrect
          signals. This can be fixed by using the <b>Reduced usage of
            operating-system signals (-Xrs)</b> option in the <a href="http://www.advancedinstaller.com/user-guide/edit-jvm-parameters-dialog.html" title="The &quot;Edit Java Virtual Machine Parameters&quot; dialog in Advanced Installer.">Edit JVM Parameters</a>
          dialog (it can be launched from the <a href="http://www.advancedinstaller.com/user-guide/java-virtual-machine.html" title="About the Java Virtual Machine in Advanced Installer">Virtual Machine</a> tab).</p><h2><a name="define-service"></a>7. Define the Service</h2><p><img src="Creating%20a%20Java%20Service%20Installation_files/services.png" alt="Services" class="float-left" title="Services" height="24" width="24"> Select
            “Services” from “Resources” menu
          on the left pane. </p><h3><a name="section334"></a>7.1 Install a new service</h3><p><img src="Creating%20a%20Java%20Service%20Installation_files/service-new.png" alt="New Service" class="float-left" title="New Service" height="24" width="24"> Click on “Services
              to Install” and select “New Service
              Installation”. In the “Choose Installation
              Dialog” click on “Application Folder”
            and select "javaservice.exe".</p><p><img src="Creating%20a%20Java%20Service%20Installation_files/new-java-service.png" alt="New Java Service" title="New Java Service" height="296" width="650"></p><h3><a name="section335"></a>7.2 Enter service properties</h3><p>Leave Service Name unchanged.</p><p>Edit the Display Name: Java Service Example.</p><p>Edit the Description: This a Java Service
            Example.</p><p>Leave the Service Parameters, Service context and Service
            Account unchanged.</p><p><img src="Creating%20a%20Java%20Service%20Installation_files/installed-service-properties.png" alt="Installed Service Properties" title="Installed Service Properties" height="643" width="417"></p><h3><a name="section336"></a>7.3 Setup the control actions</h3><p><img src="Creating%20a%20Java%20Service%20Installation_files/service-control-new.png" alt="New Service Control Operation" class="float-left" title="New Service Control Operation" height="24" width="24">Select the
            newly created service control operation. </p><p>Edit the Service Name to: javaservice.exe.</p><p>Leave anything else unchanged.</p><p><img src="Creating%20a%20Java%20Service%20Installation_files/service-control-parameters.png" alt="Service Control Parameters" title="Service Control Parameters" height="311" width="345"></p><h2><a name="build"></a>8. Build</h2><p><img src="Creating%20a%20Java%20Service%20Installation_files/project-build.png" alt="Build" class="float-left" title="Build" height="24" width="24"> Click on the <span class="button">[ Build ]</span>
          toolbar button.</p><h2><a name="testing"></a>9. Run, test and remove</h2><p>Click on the <span class="button">[ Run ]</span> toolbar button to run and
          test the MSI you created. After installation you should have a new
          service installed.</p><p>To test the application open console and enter the following
          command: telnet localhost 4444. You should see:</p><pre>Java Service is running
                        
Connection to host lost</pre><p>You also can build Java Service Example msi package using
          ant. Open a console window and change current directory to the
          directory where you unzipped the Java Service example archive. Execute
          the following command: ant msi.</p><p>To remove the installed package, simply Run it again and
          select Remove. That's it!</p><h2>The End</h2><p>This concludes our tutorial.</p></div></td></tr></tbody></table><div id="ai-footer"><div class="cont-width"><div id="footer-logos"><a href="http://www.advancedwebranking.com/" id="footer-awr">Advanced
            Web Ranking</a><a href="http://www.advancedlinkmanager.com/" id="footer-alm">Advanced
            Link Manager</a><a href="http://www.advancedwebstats.com/" id="footer-aws">Advanced
            Web Stats</a><div class="clear"></div></div><table id="footer-media"><tbody><tr><td><ul><li><a id="rss" href="http://www.advancedinstaller.com/rss-feeds.html" rel="nofollow" title="Subscribe to our feeds"><b class="media-weight">RSS Feeds</b><span>Subscribe to our feeds</span></a></li><li><a id="twitter" href="http://twitter.com/advinst" rel="nofollow" title="Follow us on Twitter"><b class="media-weight">Follow us</b><span>Twitter</span></a></li><li><a id="facebook" href="http://www.advancedinstaller.com/map.html" rel="nofollow" title="Site Map"><b class="media-weight">Site Map</b><span>Site Map tree</span></a></li><li><a id="contact" href="http://www.advancedinstaller.com/contact.html" rel="nofollow" title="Contact us"><b class="media-weight">Contact</b><span>Get in touch with us</span></a></li></ul></td></tr></tbody></table><div id="footer-copynote">© 2002 -
    2014 Caphyon Ltd. Trademarks belong to
    their respective owners. All rights reserved.</div></div></div></div></body></html>