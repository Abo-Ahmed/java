var ASF={};(function(){ASF.ExecuteOne=function(node,action){var id=action.id?action.id:node;if(action.child){id=$(id).children(action.child)}if(action.action==="update"){$(id).html(action.data)}else{if(action.action==="prepend"){$(id).prepend(action.data)}else{if(action.action==="append"){$(id).append(action.data)}else{if(action.action==="show"){$(id).show("slow")}else{if(action.action==="hide"){$(id).hide("slow")}else{if(action.action==="delete"){$(id).remove()}else{if(action.action==="removeClass"){$(id).removeClass(action.data)}else{if(action.action==="addClass"){$(id).addClass(action.data)}else{if(action.action==="fadeIn"){$(id).fadeIn("slow")}else{if(action.action==="fadeOut"){$(id).fadeOut("slow")}else{if(action.action==="slideUp"){$(id).slideUp("slow")}else{if(action.action==="slideDown"){$(id).slideDown("slow")}else{if(action.action==="closeDialog"){$(id).dialog("close")}else{if(action.action==="closePopup"){$(id).popup("close")}else{if(action.action==="redirect"){document.location=action.url}else{if(action.action==="message"){ASF.Message(node,action.id,action.data)}else{if(action.action==="notification"){ASF.Message(node,action.id,action.data,"asf-notification").message("autoClose")}else{if(action.action==="script"){try{eval(action.script)}catch(e){alert(e)}}else{if(action.action==="clear"){$(id).each(function(){switch(this.type){case"password":case"select-multiple":case"select-one":case"text":case"textarea":$(this).val("");break;case"checkbox":case"radio":this.checked=false;break}})}}}}}}}}}}}}}}}}}}}};ASF.Execute=function(node,data){if(data){for(var i=0;i<data.length;i++){ASF.ExecuteOne(node,data[i])}}};ASF.AjaxError=function(jqXHDR,status,error,node){var contentType=jqXHDR.getResponseHeader("Content-type");if(contentType&&contentType.match(/^application\/json(;.*)?$/i)){var data=$.parseJSON(jqXHDR.responseText);ASF.Execute(node,data)}else{ASF.Message(node,null,"Operation failed")}};ASF.Update=function(node,url,target,complete){var d;if(target!=null){d=$(target)}else{d=$(node);if(!d.is(".asf-container")){d=d.parent(".asf-container")}}if(d.length>0){jQuery.ajax({url:url,context:document.body,success:function(data,status,jqXHDR){var contentType=jqXHDR.getResponseHeader("Content-type");if(contentType==null){contentType="text/html"}if(contentType.match(/^text\/(html|xml)(;.*)?$/i)){d.html(jqXHDR.responseText)}else{if(contentType.match(/^application\/json(;.*)?$/i)){ASF.Execute(d,data)}}if(complete!=null){complete(d,jqXHDR)}},error:function(jqXHDR,status,error){ASF.AjaxError(jqXHDR,status,error,d)}})}};ASF.Submit=function(node){var f=$(node).closest("form");var d=$(f);if(!d.is(".asf-container,ui-dialog-content")){d=d.closest(".asf-container,.ui-dialog-content")}if(d.length==0){d=$(f).parent()}if(d.length>0){var params;var params=$(f).serialize();var url=$(f).attr("action");if(node.tagName=="a"||node.tagName=="A"){params=node.id+"=1&"+$(f).serialize()}else{params=node.name+"=1&"+$(f).serialize()}$(f).triggerHandler("notifySubmit",d);jQuery.ajax({type:"POST",url:url,data:params,context:document.body,success:function(data,status,jqXHDR){var contentType=jqXHDR.getResponseHeader("Content-type");if(contentType==null){contentType="text/html"}$(f).triggerHandler("successSubmit",d);if(contentType.match(/^text\/(html|xml)(;.*)?$/i)){d.fadeOut("fast",function(){d.html(jqXHDR.responseText);d.fadeIn("fast")})}else{if(contentType.match(/^application\/json(;.*)?$/i)){ASF.Execute(d,data)}}},error:function(jqXHDR,status,error){ASF.AjaxError(jqXHDR,status,error,d)}})}return false};ASF.Post=function(node,url,params){jQuery.ajax({type:"POST",url:url,data:params,context:document.body,success:function(data,status,jqXHDR){var contentType=jqXHDR.getResponseHeader("Content-type");if(contentType==null){contentType="text/html"}if(contentType.match(/^text\/(html|xml)(;.*)?$/i)){$(node).html(jqXHDR.responseText)}else{if(contentType.match(/^application\/json(;.*)?$/i)){ASF.Execute(node,data)}}},error:function(jqXHDR,status,error){ASF.AjaxError(jqXHDR,status,error,node)}});return false};ASF.Popup=function(node,id,url,params){jQuery.ajax({type:"GET",url:url,context:document.body,success:function(data,status,jqXHDR){var contentType=jqXHDR.getResponseHeader("Content-type");if(contentType==null){contentType="text/html"}var div=$("#"+id);if(div.length==0){div=document.createElement("div");div.id=id;$(document.body).append($(div))}if(contentType.match(/^text\/(html|xml)(;.*)?$/i)){$(div).html(jqXHDR.responseText)}else{if(contentType.match(/^application\/json(;.*)?$/i)){ASF.Execute(div,data)}}$(div).popup(params).popup("open");$(div).find("form:not(.filter) :input:visible:first").focus()},error:function(jqXHDR,status,error){ASF.AjaxError(jqXHDR,status,error,node)}});return false};ASF.OpenDialog=function(node,id,url,params){var div=$(id);if(div.length>0){return false}div=document.createElement("div");div.id=id;div=$(div);var d=$(document);if(d.length==0){return false}$(d).append($(div));jQuery.ajax({url:url,context:document.body,success:function(data,status,jqXHDR){var contentType=jqXHDR.getResponseHeader("Content-type");if(contentType==null){contentType="text/html"}if(contentType.match(/^text\/(html|xml)(;.*)?$/i)){$(div).dialog({autoOpen:false,show:"blind",hide:"explode",minWidth:600,close:function(){$(div).dialog("destroy");$(div).remove();if(params&&params.close){params.close(node)}}});$(div).html(jqXHDR.responseText);var dTitle,dBox=$(div).children("div");if(dBox.length==0){dTitle=$(div).children("h2")}else{dTitle=$(dBox).children("h2")}if(dTitle.length>0){$(div).dialog("option","title",dTitle.html());dTitle.remove()}else{dTitle=$(div).children("div").attr("title");if(dTitle!=null){$(div).dialog("option","title",dTitle)}}$(div).dialog("open")}else{if(contentType.match(/^application\/json(;.*)?$/i)){ASF.Execute(node,data)}}},error:function(jqXHDR,status,error){ASF.AjaxError(jqXHDR,status,error,d)}});return false};ASF.CloseDialog=function(id){$("#"+id).dialog("close");return false};ASF.Message=function(node,id,message,css){if(!id){id="#asf-message"}var div=$(id);if(div.length==0){div=document.createElement("div");div.id=id.substring(1);$(document.body).append($(div))}else{$(div).removeClass()}if(css){$(div).addClass(css)}return $(div).html(message).message({}).message("attachment",node)}})();