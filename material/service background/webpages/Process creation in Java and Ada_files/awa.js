var AWA=AWA||{};jQuery.fn.extend({modal:function(a){if(!this.length){return null}var b=$.data(this[0],"modal");if(!b){b=new $.modal(a,this[0]);$.data(this[0],"modal",b)}return b}});$.modal=function(a,b){this.settings=$.extend(true,{},$.modal.defaults,a);this.currentField=b;this.init()};$.extend($.modal,{defaults:{url:null,allow_close:false,},setDefaults:function(a){$.extend($.modal.defaults,a)},prototype:{init:function(){var a=this;this.overlay=$("#awa-overlay");if(this.overlay===null||!this.overlay.length){var b=document.createElement("div");b.id="awa-overlay";document.body.appendChild(b);this.overlay=$(b)}this.dialog=document.createElement("div");this.dialog.className="awa-modal";document.body.appendChild(this.dialog);$(a.currentField).bind("click",function(c){a.show();return false})},show:function(){var a=this;$(this.dialog).addClass("awa-modal-show");$(this.overlay).addClass("awa-overlay-show");if(a.settings.allow_close){$(this.overlay).bind("click",function(b){a.close()})}jQuery.ajax({url:a.settings.url,context:document.body,success:function(c,b,d){var e=d.getResponseHeader("Content-type");if(e===null){e="text/html"}if(e.match(/^text\/(html|xml)(;.*)?$/i)){$(a.dialog).html(d.responseText)}else{if(e.match(/^application\/json(;.*)?$/i)){ASF.Execute(a.dialog,c)}}},error:function(d,b,c){ASF.AjaxError(d,b,c,a.dialog)}})},close:function(){$(this.overlay).removeClass("awa-overlay-show");$(this.dialog).removeClass("awa-modal-show")}}});